package com.xy.scpms.model.reports;

import com.xy.scpms.model.reports.common.ShipDeliveryRpt;

import java.sql.Timestamp;

import java.util.Calendar;

import oracle.adf.share.ADFContext;
import oracle.adf.share.security.SecurityContext;

import oracle.jbo.domain.Date;
import oracle.jbo.server.ViewObjectImpl;

import oracle.sql.DATE;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Fri Mar 23 13:54:56 CST 2012
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class ShipDeliveryRptImpl extends ViewObjectImpl implements ShipDeliveryRpt {
    /**
     * This is the default constructor (do not remove).
     */
    public ShipDeliveryRptImpl() {
    }

    public void clearRowSet() {
        executeEmptyRowSet();
    }

    public oracle.jbo.domain.Date toOracleDate(java.util.Calendar calendar) {
        oracle.jbo.domain.Date jboDate = new oracle.jbo.domain.Date();
        Timestamp t = jboDate.timestampValue();
        t.setTime(calendar.getTime().getTime());
        return new oracle.jbo.domain.Date(t);
    }


    public void runReport(String dept, Date start, Date end) {
        System.err.println(start);
        System.err.println(end);
        SecurityContext context = ADFContext.getCurrent().getSecurityContext();
        this.setApplyViewCriteriaNames(null);

        if (context.isUserInRole("design_director")) {
//            System.err.println("director");
            this.applyViewCriteria(getViewCriteria("filterByDept"));
            this.setdept(dept);
        } else if (context.isUserInRole("contractor") || context.isUserInRole("marketing_director") ||
                   context.isUserInRole("vip")) {
//            System.err.println("vip");
            //do nothing
        } else {
//            System.err.println("mgr");
            this.applyViewCriteria(getViewCriteria("filterByMgr"));
            //value set by groovy expr inside the viewobject itself
        }
        this.applyViewCriteria(getViewCriteria("filterByRange"),true);

        java.sql.Date sysdate = null;
        try {
            if (start == null) {
                Calendar cal = Calendar.getInstance();
                cal.set(Calendar.MONTH, 0);
                cal.set(Calendar.DAY_OF_MONTH, 1);
                cal.set(Calendar.HOUR_OF_DAY,0);
                cal.set(Calendar.MINUTE,0);
                cal.set(Calendar.SECOND,0);
                start = toOracleDate(cal);
                System.err.println(start);
            }

            if (end == null) {
                Calendar cal = Calendar.getInstance();
                cal.set(Calendar.MONTH, 11);
                cal.set(Calendar.DAY_OF_MONTH, 31);
                cal.set(Calendar.HOUR_OF_DAY,0);
                cal.set(Calendar.MINUTE,0);
                cal.set(Calendar.SECOND,0);
                end = toOracleDate(cal);
                System.err.println(end);
            }


        } catch (Exception e) {
            // TODO: Add catch code
            e.printStackTrace();
        }
        this.setStart(start);
        this.setEnd(end);
        this.executeQuery();
    }

    /**
     * Returns the variable value for dept.
     * @return variable value for dept
     */
    public String getdept() {
        return (String)ensureVariableManager().getVariableValue("dept");
    }

    /**
     * Sets <code>value</code> for variable dept.
     * @param value value to bind as dept
     */
    public void setdept(String value) {
        ensureVariableManager().setVariableValue("dept", value);
    }

    /**
     * Returns the variable value for mgr.
     * @return variable value for mgr
     */
    public String getmgr() {
        return (String)ensureVariableManager().getVariableValue("mgr");
    }

    /**
     * Sets <code>value</code> for variable mgr.
     * @param value value to bind as mgr
     */
    public void setmgr(String value) {
        ensureVariableManager().setVariableValue("mgr", value);
    }

    /**
     * Returns the variable value for start.
     * @return variable value for start
     */
    public Date getStart() {
        return (Date)ensureVariableManager().getVariableValue("startdate");
    }

    /**
     * Sets <code>value</code> for variable start.
     * @param value value to bind as start
     */
    public void setStart(Date value) {
        ensureVariableManager().setVariableValue("startdate", value);
    }

    /**
     * Returns the variable value for end.
     * @return variable value for end
     */
    public Date getEnd() {
        return (Date)ensureVariableManager().getVariableValue("enddate");
    }

    /**
     * Sets <code>value</code> for variable end.
     * @param value value to bind as end
     */
    public void setEnd(Date value) {
        ensureVariableManager().setVariableValue("enddate", value);
    }

    /**
     * Returns the variable value for start.
     * @return variable value for start
     */
    public Date getstartdate() {
        return (Date)ensureVariableManager().getVariableValue("startdate");
    }

    /**
     * Sets <code>value</code> for variable start.
     * @param value value to bind as start
     */
    public void setstartdate(Date value) {
        ensureVariableManager().setVariableValue("startdate", value);
    }

    /**
     * Returns the variable value for end.
     * @return variable value for end
     */
    public Date getenddate() {
        return (Date)ensureVariableManager().getVariableValue("enddate");
    }

    /**
     * Sets <code>value</code> for variable end.
     * @param value value to bind as end
     */
    public void setenddate(Date value) {
        ensureVariableManager().setVariableValue("enddate", value);
    }
}
